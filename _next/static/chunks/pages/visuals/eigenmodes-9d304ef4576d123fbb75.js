_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{"/0+H":function(t,e,r){"use strict";e.__esModule=!0,e.isInAmpMode=i,e.useAmp=function(){return i(n.default.useContext(s.AmpStateContext))};var o,n=(o=r("q1tI"))&&o.__esModule?o:{default:o},s=r("lwAK");function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.ampFirst,r=void 0!==e&&e,o=t.hybrid,n=void 0!==o&&o,s=t.hasQuery,i=void 0!==s&&s;return r||n&&i}},"/GRZ":function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},"1l7s":function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/visuals/eigenmodes",function(){return r("Z51P")}])},"2qu3":function(t,e,r){"use strict";var o=r("oI91"),n=r("/GRZ"),s=r("i2R6");function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"===typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return i=t.done,t},e:function(t){u=!0,s=t},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw s}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}e.__esModule=!0,e.default=void 0;var h,c=(h=r("q1tI"))&&h.__esModule?h:{default:h},f=r("8L3h"),m=r("jwwS");var p=[],g=[],d=!1;function w(t){var e=t(),r={loading:!0,loaded:null,error:null};return r.promise=e.then((function(t){return r.loading=!1,r.loaded=t,t})).catch((function(t){throw r.loading=!1,r.error=t,t})),r}function b(t){var e={loading:!1,loaded:{},error:null},r=[];try{Object.keys(t).forEach((function(o){var n=w(t[o]);n.loading?e.loading=!0:(e.loaded[o]=n.loaded,e.error=n.error),r.push(n.promise),n.promise.then((function(t){e.loaded[o]=t})).catch((function(t){e.error=t}))}))}catch(o){e.error=o}return e.promise=Promise.all(r).then((function(t){return e.loading=!1,t})).catch((function(t){throw e.loading=!1,t})),e}function y(t,e){return c.default.createElement(function(t){return t&&t.__esModule?t.default:t}(t),e)}function M(t,e){var r=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:y,webpack:null,modules:null},e),o=null;function n(){if(!o){var e=new v(t,r);o={getCurrentValue:e.getCurrentValue.bind(e),subscribe:e.subscribe.bind(e),retry:e.retry.bind(e),promise:e.promise.bind(e)}}return o.promise()}if(!d&&"function"===typeof r.webpack){var s=r.webpack();g.push((function(t){var e,r=a(s);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(-1!==t.indexOf(o))return n()}}catch(i){r.e(i)}finally{r.f()}}))}var i=function(t,e){n();var s=c.default.useContext(m.LoadableContext),i=(0,f.useSubscription)(o);return c.default.useImperativeHandle(e,(function(){return{retry:o.retry}}),[]),s&&Array.isArray(r.modules)&&r.modules.forEach((function(t){s(t)})),c.default.useMemo((function(){return i.loading||i.error?c.default.createElement(r.loading,{isLoading:i.loading,pastDelay:i.pastDelay,timedOut:i.timedOut,error:i.error,retry:o.retry}):i.loaded?r.render(i.loaded,t):null}),[t,i])};return i.preload=function(){return n()},i.displayName="LoadableComponent",c.default.forwardRef(i)}var v=function(){function t(e,r){n(this,t),this._loadFn=e,this._opts=r,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}return s(t,[{key:"promise",value:function(){return this._res.promise}},{key:"retry",value:function(){var t=this;this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};var e=this._res,r=this._opts;e.loading&&("number"===typeof r.delay&&(0===r.delay?this._state.pastDelay=!0:this._delay=setTimeout((function(){t._update({pastDelay:!0})}),r.delay)),"number"===typeof r.timeout&&(this._timeout=setTimeout((function(){t._update({timedOut:!0})}),r.timeout))),this._res.promise.then((function(){t._update({}),t._clearTimeouts()})).catch((function(e){t._update({}),t._clearTimeouts()})),this._update({})}},{key:"_update",value:function(t){this._state=u(u({},this._state),{},{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},t),this._callbacks.forEach((function(t){return t()}))}},{key:"_clearTimeouts",value:function(){clearTimeout(this._delay),clearTimeout(this._timeout)}},{key:"getCurrentValue",value:function(){return this._state}},{key:"subscribe",value:function(t){var e=this;return this._callbacks.add(t),function(){e._callbacks.delete(t)}}}]),t}();function x(t){return M(w,t)}function E(t,e){for(var r=[];t.length;){var o=t.pop();r.push(o(e))}return Promise.all(r).then((function(){if(t.length)return E(t,e)}))}x.Map=function(t){if("function"!==typeof t.render)throw new Error("LoadableMap requires a `render(loaded, props)` function");return M(b,t)},x.preloadAll=function(){return new Promise((function(t,e){E(p).then(t,e)}))},x.preloadReady=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise((function(e){var r=function(){return d=!0,e()};E(g,t).then(r,r)}))},window.__NEXT_PRELOADREADY=x.preloadReady;var S=x;e.default=S},"48fX":function(t,e,r){var o=r("qhzo");t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}},"5fIB":function(t,e,r){var o=r("7eYB");t.exports=function(t){if(Array.isArray(t))return o(t)}},"7eYB":function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}},"8Kt/":function(t,e,r){"use strict";r("oI91");e.__esModule=!0,e.defaultHead=h,e.default=void 0;var o,n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=o?Object.getOwnPropertyDescriptor(t,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=t[n]}r.default=t,e&&e.set(t,r);return r}(r("q1tI")),s=(o=r("Xuae"))&&o.__esModule?o:{default:o},i=r("lwAK"),u=r("FYa8"),a=r("/0+H");function l(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function h(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[n.default.createElement("meta",{charSet:"utf-8"})];return t||e.push(n.default.createElement("meta",{name:"viewport",content:"width=device-width"})),e}function c(t,e){return"string"===typeof e||"number"===typeof e?t:e.type===n.default.Fragment?t.concat(n.default.Children.toArray(e.props.children).reduce((function(t,e){return"string"===typeof e||"number"===typeof e?t:t.concat(e)}),[])):t.concat(e)}var f=["name","httpEquiv","charSet","itemProp"];function m(t,e){return t.reduce((function(t,e){var r=n.default.Children.toArray(e.props.children);return t.concat(r)}),[]).reduce(c,[]).reverse().concat(h(e.inAmpMode)).filter(function(){var t=new Set,e=new Set,r=new Set,o={};return function(n){var s=!0;if(n.key&&"number"!==typeof n.key&&n.key.indexOf("$")>0){var i=n.key.slice(n.key.indexOf("$")+1);t.has(i)?s=!1:t.add(i)}switch(n.type){case"title":case"base":e.has(n.type)?s=!1:e.add(n.type);break;case"meta":for(var u=0,a=f.length;u<a;u++){var l=f[u];if(n.props.hasOwnProperty(l))if("charSet"===l)r.has(l)?s=!1:r.add(l);else{var h=n.props[l],c=o[l]||new Set;c.has(h)?s=!1:(c.add(h),o[l]=c)}}}return s}}()).reverse().map((function(t,e){var r=t.key||e;return n.default.cloneElement(t,{key:r})}))}function p(t){var e=t.children,r=(0,n.useContext)(i.AmpStateContext),o=(0,n.useContext)(u.HeadManagerContext);return n.default.createElement(s.default,{reduceComponentsToState:m,headManager:o,inAmpMode:(0,a.isInAmpMode)(r)},e)}p.rewind=function(){};var g=p;e.default=g},"C+bE":function(t,e){function r(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=r=function(t){return typeof t}:t.exports=r=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(e)}t.exports=r},FYa8:function(t,e,r){"use strict";var o;e.__esModule=!0,e.HeadManagerContext=void 0;var n=((o=r("q1tI"))&&o.__esModule?o:{default:o}).default.createContext({});e.HeadManagerContext=n},KckH:function(t,e,r){var o=r("7eYB");t.exports=function(t,e){if(t){if("string"===typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}},NTCN:function(t,e,r){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.r(e),r.d(e,"ELEMS",(function(){return T}));const s=Object.prototype.toString;function i(t){return s.call(t).endsWith("Array]")}var u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=t[o],a=o+1;a<s;a++)t[a]>u&&(u=t[a]);return u};var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,o=void 0===r?0:r,n=e.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var u=t[o],a=o+1;a<s;a++)t[a]<u&&(u=t[a]);return u};var l=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!i(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var o=a(t),n=u(t);if(o===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=r.min,l=void 0===s?r.autoMinMax?o:0:s,h=r.max,c=void 0===h?r.autoMinMax?n:1:h;if(l>=c)throw new RangeError("min option must be smaller than max option");for(var f=(c-l)/(n-o),m=0;m<t.length;m++)e[m]=(t[m]-o)*f+l;return e};const h=" ".repeat(2),c=" ".repeat(4);function f(t,e={}){const{maxRows:r=15,maxColumns:o=10,maxNumSize:n=8}=e;return`${t.constructor.name} {\n${h}[\n${c}${function(t,e,r,o){const{rows:n,columns:s}=t,i=Math.min(n,e),u=Math.min(s,r),a=[];for(let l=0;l<i;l++){let e=[];for(let r=0;r<u;r++)e.push(m(t.get(l,r),o));a.push(""+e.join(" "))}u!==s&&(a[a.length-1]+=` ... ${s-r} more columns`);i!==n&&a.push(`... ${n-e} more rows`);return a.join("\n"+c)}(t,r,o,n)}\n${h}]\n${h}rows: ${t.rows}\n${h}columns: ${t.columns}\n}`}function m(t,e){const r=String(t);if(r.length<=e)return r.padEnd(e," ");const o=t.toPrecision(e-2);if(o.length<=e)return o;const n=t.toExponential(e-2),s=n.indexOf("e"),i=n.slice(s);return n.slice(0,e-i.length)+i}function p(t,e,r){let o=r?t.rows:t.rows-1;if(e<0||e>o)throw new RangeError("Row index out of range")}function g(t,e,r){let o=r?t.columns:t.columns-1;if(e<0||e>o)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function w(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function b(t,e){if("object"!==typeof e)throw new TypeError("unexpected type for row indices");if(e.some(e=>e<0||e>=t.rows))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function y(t,e){if("object"!==typeof e)throw new TypeError("unexpected type for column indices");if(e.some(e=>e<0||e>=t.columns))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function M(t,e,r,o,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(x("startRow",e),x("endRow",r),x("startColumn",o),x("endColumn",n),e>r||o>n||e<0||e>=t.rows||r<0||r>=t.rows||o<0||o>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t,e=0){let r=[];for(let o=0;o<t;o++)r.push(e);return r}function x(t,e){if("number"!==typeof e)throw new TypeError(t+" must be a number")}class E{static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("data length does not match given dimensions");let o=new _(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)o.set(n,t,r[n*e+t]);return o}static rowVector(t){let e=new _(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new _(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new _(t,e)}static ones(t,e){return new _(t,e).fill(1)}static rand(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{random:o=Math.random}=r;let n=new _(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,o());return n}static randInt(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{min:o=0,max:n=1e3,random:s=Math.random}=r;if(!Number.isInteger(o))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(o>=n)throw new RangeError("min must be smaller than max");let i=n-o,u=new _(t,e);for(let a=0;a<t;a++)for(let t=0;t<e;t++){let e=o+Math.round(s()*i);u.set(a,t,e)}return u}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let o=Math.min(t,e),n=this.zeros(t,e);for(let s=0;s<o;s++)n.set(s,s,r);return n}static diag(t,e,r){let o=t.length;void 0===e&&(e=o),void 0===r&&(r=e);let n=Math.min(o,e,r),s=this.zeros(e,r);for(let i=0;i<n;i++)s.set(i,i,t[i]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new _(r,o);for(let s=0;s<r;s++)for(let r=0;r<o;r++)n.set(s,r,Math.min(t.get(s,r),e.get(s,r)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,o=t.columns,n=new this(r,o);for(let s=0;s<r;s++)for(let r=0;r<o;r++)n.set(s,r,Math.max(t.get(s,r),e.get(s,r)));return n}static checkMatrix(t){return E.isMatrix(t)?t:new _(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!==typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);t++}return o}isReducedEchelonForm(){let t=0,e=0,r=-1,o=!0,n=!1;for(;t<this.rows&&o;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(o=!1,n=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(o=!1);t++}return o}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let o=e;for(let n=e;n<t.rows;n++)t.get(n,r)>t.get(o,r)&&(o=n);if(0===t.get(o,r))r++;else{t.swapRows(e,o);let n=t.get(e,r);for(let o=r;o<t.columns;o++)t.set(e,o,t.get(e,o)/n);for(let o=e+1;o<t.rows;o++){let n=t.get(o,r)/t.get(e,r);t.set(o,r,0);for(let s=r+1;s<t.columns;s++)t.set(o,s,t.get(o,s)-t.get(e,s)*n)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,o=r-1;for(;o>=0;)if(0===t.maxRow(o))o--;else{let n=0,s=!1;for(;n<r&&!1===s;)1===t.get(o,n)?s=!0:n++;for(let r=0;r<o;r++){let s=t.get(r,n);for(let i=n;i<e;i++){let e=t.get(r,i)-s*t.get(o,i);t.set(r,i,e)}}o--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let o=new _(this.rows*e,this.columns*r);for(let n=0;n<e;n++)for(let t=0;t<r;t++)o.setSubMatrix(this,this.rows*n,this.columns*t);return o}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){p(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return _.rowVector(this.getRow(t))}setRow(t,e){p(this,t),e=d(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){p(this,t),p(this,e);for(let r=0;r<this.columns;r++){let o=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,o)}return this}getColumn(t){g(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return _.columnVector(this.getColumn(t))}setColumn(t,e){g(this,t),e=w(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){g(this,t),g(this,e);for(let r=0;r<this.rows;r++){let o=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,o)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=w(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){p(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){g(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)>t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}min(){let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let o=0;o<this.columns;o++)this.get(r,o)<t&&(t=this.get(r,o),e[0]=r,e[1]=o);return e}maxRow(t){p(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){p(this,t);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)>e&&(e=this.get(t,o),r[1]=o);return r}minRow(t){p(this,t);let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){p(this,t);let e=this.get(t,0),r=[t,0];for(let o=1;o<this.columns;o++)this.get(t,o)<e&&(e=this.get(t,o),r[1]=o);return r}maxColumn(t){g(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){g(this,t);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)>e&&(e=this.get(o,t),r[0]=o);return r}minColumn(t){g(this,t);let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){g(this,t);let e=this.get(0,t),r=[0,t];for(let o=1;o<this.rows;o++)this.get(o,t)<e&&(e=this.get(o,t),r[0]=o);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){let e=0;if("max"===t)return this.max();if("frobenius"===t){for(let t=0;t<this.rows;t++)for(let r=0;r<this.columns;r++)e+=this.get(t,r)*this.get(t,r);return Math.sqrt(e)}throw new RangeError("unknown norm type: "+t)}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){E.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let o=0;o<e.length;o++)r+=e[o]*t[o];return r}mmul(t){t=_.checkMatrix(t);let e=this.rows,r=this.columns,o=t.columns,n=new _(e,o),s=new Float64Array(r);for(let i=0;i<o;i++){for(let e=0;e<r;e++)s[e]=t.get(e,i);for(let t=0;t<e;t++){let e=0;for(let o=0;o<r;o++)e+=this.get(t,o)*s[o];n.set(t,i,e)}}return n}strassen2x2(t){t=_.checkMatrix(t);let e=new _(2,2);const r=this.get(0,0),o=t.get(0,0),n=this.get(0,1),s=t.get(0,1),i=this.get(1,0),u=t.get(1,0),a=this.get(1,1),l=t.get(1,1),h=(r+a)*(o+l),c=(i+a)*o,f=r*(s-l),m=a*(u-o),p=(r+n)*l,g=h+m-p+(n-a)*(u+l),d=f+p,w=c+m,b=h-c+f+(i-r)*(o+s);return e.set(0,0,g),e.set(0,1,d),e.set(1,0,w),e.set(1,1,b),e}strassen3x3(t){t=_.checkMatrix(t);let e=new _(3,3);const r=this.get(0,0),o=this.get(0,1),n=this.get(0,2),s=this.get(1,0),i=this.get(1,1),u=this.get(1,2),a=this.get(2,0),l=this.get(2,1),h=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),p=t.get(1,0),g=t.get(1,1),d=t.get(1,2),w=t.get(2,0),b=t.get(2,1),y=t.get(2,2),M=(r-s)*(-f+g),v=(-r+s+i)*(c-f+g),x=(s+i)*(-c+f),E=r*c,S=(-r+a+l)*(c-m+d),R=(-r+a)*(m-d),A=(a+l)*(-c+m),k=(-n+l+h)*(g+w-b),O=(n-h)*(g-b),j=n*w,I=(l+h)*(-w+b),C=(-n+i+u)*(d+w-y),T=(n-u)*(d-y),q=(i+u)*(-w+y),P=E+j+o*p,D=(r+o+n-s-i-l-h)*g+v+x+E+k+j+I,N=E+S+A+(r+o+n-i-u-a-l)*d+j+C+q,F=M+i*(-c+f+p-g-d-w+y)+v+E+j+C+T,V=M+v+x+E+u*b,L=j+C+T+q+s*m,z=E+S+R+l*(-c+m+p-g-d-w+b)+k+O+j,H=k+O+j+I+a*f,$=E+S+R+A+h*y;return e.set(0,0,P),e.set(0,1,D),e.set(0,2,N),e.set(1,0,F),e.set(1,1,V),e.set(1,2,L),e.set(2,0,z),e.set(2,1,H),e.set(2,2,$),e}mmulStrassen(t){t=_.checkMatrix(t);let e=this.clone(),r=e.rows,o=e.columns,n=t.rows,s=t.columns;function i(t,e,r){let o=t.rows,n=t.columns;if(o===e&&n===r)return t;{let o=E.zeros(e,r);return o=o.setSubMatrix(t,0,0),o}}o!==n&&console.warn(`Multiplying ${r} x ${o} and ${n} x ${s} matrix: dimensions do not match.`);let u=Math.max(r,n),a=Math.max(o,s);return e=i(e,u,a),function t(e,r,o,n){if(o<=512||n<=512)return e.mmul(r);o%2===1&&n%2===1?(e=i(e,o+1,n+1),r=i(r,o+1,n+1)):o%2===1?(e=i(e,o+1,n),r=i(r,o+1,n)):n%2===1&&(e=i(e,o,n+1),r=i(r,o,n+1));let s=parseInt(e.rows/2,10),u=parseInt(e.columns/2,10),a=e.subMatrix(0,s-1,0,u-1),l=r.subMatrix(0,s-1,0,u-1),h=e.subMatrix(0,s-1,u,e.columns-1),c=r.subMatrix(0,s-1,u,r.columns-1),f=e.subMatrix(s,e.rows-1,0,u-1),m=r.subMatrix(s,r.rows-1,0,u-1),p=e.subMatrix(s,e.rows-1,u,e.columns-1),g=r.subMatrix(s,r.rows-1,u,r.columns-1),d=t(E.add(a,p),E.add(l,g),s,u),w=t(E.add(f,p),l,s,u),b=t(a,E.sub(c,g),s,u),y=t(p,E.sub(m,l),s,u),M=t(E.add(a,h),g,s,u),v=t(E.sub(f,a),E.add(l,c),s,u),x=t(E.sub(h,p),E.add(m,g),s,u),S=E.add(d,y);S.sub(M),S.add(x);let _=E.add(b,M),R=E.add(w,y),A=E.sub(d,w);A.add(b),A.add(v);let k=E.zeros(2*S.rows,2*S.columns);return k=k.setSubMatrix(S,0,0),k=k.setSubMatrix(_,S.rows,0),k=k.setSubMatrix(R,0,S.columns),k=k.setSubMatrix(A,S.rows,S.columns),k.subMatrix(0,o-1,0,n-1)}(e,t=i(t,u,a),u,a)}scaleRows(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new _(this.rows,this.columns);for(let n=0;n<this.rows;n++){const t=this.getRow(n);l(t,{min:e,max:r,output:t}),o.setRow(n,t)}return o}scaleColumns(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let o=new _(this.rows,this.columns);for(let n=0;n<this.columns;n++){const t=this.getColumn(n);l(t,{min:e,max:r,output:t}),o.setColumn(n,t)}return o}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),o=this.get(e,this.columns-1-r);this.set(e,r,o),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),o=this.get(this.rows-1-r,e);this.set(r,e,o),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=_.checkMatrix(t);let e=this.rows,r=this.columns,o=t.rows,n=t.columns,s=new _(e*o,r*n);for(let i=0;i<e;i++)for(let e=0;e<r;e++)for(let r=0;r<o;r++)for(let u=0;u<n;u++)s.set(o*i+r,n*e+u,this.get(i,e)*t.get(r,u));return s}transpose(){let t=new _(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=S){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=S){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,o){M(this,t,e,r,o);let n=new _(e-t+1,o-r+1);for(let s=t;s<=e;s++)for(let e=r;e<=o;e++)n.set(s-t,e-r,this.get(s,e));return n}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let o=new _(t.length,r-e+1);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError("Row index out of range: "+t[n]);o.set(n,s-e,this.get(t[n],s))}return o}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let o=new _(r-e+1,t.length);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError("Column index out of range: "+t[n]);o.set(s-e,n,this.get(s,t[n]))}return o}setSubMatrix(t,e,r){M(this,e,e+(t=_.checkMatrix(t)).rows-1,r,r+t.columns-1);for(let o=0;o<t.rows;o++)for(let n=0;n<t.columns;n++)this.set(e+o,r+n,t.get(o,n));return this}selection(t,e){let r=function(t,e,r){return{row:b(t,e),column:y(t,r)}}(this,t,e),o=new _(t.length,e.length);for(let n=0;n<r.row.length;n++){let t=r.row[n];for(let e=0;e<r.column.length;e++){let s=r.column[e];o.set(n,e,this.get(t,s))}}return o}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){let t=new _(this.rows,this.columns);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}sum(t){switch(t){case"row":return function(t){let e=v(t.rows);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]+=t.get(r,o);return e}(this);case"column":return function(t){let e=v(t.columns);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]+=t.get(r,o);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e+=t.get(r,o);return e}(this);default:throw new Error("invalid option: "+t)}}product(t){switch(t){case"row":return function(t){let e=v(t.rows,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[r]*=t.get(r,o);return e}(this);case"column":return function(t){let e=v(t.columns,1);for(let r=0;r<t.rows;++r)for(let o=0;o<t.columns;++o)e[o]*=t.get(r,o);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)e*=t.get(r,o);return e}(this);default:throw new Error("invalid option: "+t)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: "+t)}}variance(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:o=this.mean(t)}=e;if("boolean"!==typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(o))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,s=[];for(let i=0;i<o;i++){let o=0,u=0,a=0;for(let e=0;e<n;e++)a=t.get(i,e)-r[i],o+=a,u+=a*a;e?s.push((u-o*o/n)/(n-1)):s.push((u-o*o/n)/n)}return s}(this,r,o);case"column":if(!Array.isArray(o))throw new TypeError("mean must be an array");return function(t,e,r){const o=t.rows,n=t.columns,s=[];for(let i=0;i<n;i++){let n=0,u=0,a=0;for(let e=0;e<o;e++)a=t.get(e,i)-r[i],n+=a,u+=a*a;e?s.push((u-n*n/o)/(o-1)):s.push((u-n*n/o)/o)}return s}(this,r,o);case void 0:if("number"!==typeof o)throw new TypeError("mean must be a number");return function(t,e,r){const o=t.rows,n=t.columns,s=o*n;let i=0,u=0,a=0;for(let l=0;l<o;l++)for(let e=0;e<n;e++)a=t.get(l,e)-r,i+=a,u+=a*a;return e?(u-i*i/s)/(s-1):(u-i*i/s)/s}(this,r,o);default:throw new Error("invalid option: "+t)}}standardDeviation(t,e){"object"===typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let o=0;o<r.length;o++)r[o]=Math.sqrt(r[o]);return r}center(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[r])}(this,r),this;case"column":if(!Array.isArray(r))throw new TypeError("center must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e[o])}(this,r),this;case void 0:if("number"!==typeof r)throw new TypeError("center must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)-e)}(this,r),this;default:throw new Error("invalid option: "+t)}}scale(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.rows;r++){let o=0;for(let e=0;e<t.columns;e++)o+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(o))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){const e=[];for(let r=0;r<t.columns;r++){let o=0;for(let e=0;e<t.rows;e++)o+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(o))}return e}(this);else if(!Array.isArray(r))throw new TypeError("scale must be an array");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e[o])}(this,r),this;case void 0:if(void 0===r)r=function(t){const e=t.size-1;let r=0;for(let o=0;o<t.columns;o++)for(let n=0;n<t.rows;n++)r+=Math.pow(t.get(n,o),2)/e;return Math.sqrt(r)}(this);else if("number"!==typeof r)throw new TypeError("scale must be a number");return function(t,e){for(let r=0;r<t.rows;r++)for(let o=0;o<t.columns;o++)t.set(r,o,t.get(r,o)/e)}(this,r),this;default:throw new Error("invalid option: "+t)}}toString(t){return f(this,t)}}function S(t,e){return t-e}E.prototype.klass="Matrix","undefined"!==typeof Symbol&&(E.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return f(this)}),E.random=E.rand,E.randomInt=E.randInt,E.diagonal=E.diag,E.prototype.diagonal=E.prototype.diag,E.identity=E.eye,E.prototype.negate=E.prototype.neg,E.prototype.tensorProduct=E.prototype.kroneckerProduct;class _ extends E{constructor(t,e){if(super(),_.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(this.data=[],!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!==typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let o=0;o<t;o++){if(r[o].length!==e)throw new RangeError("Inconsistent array dimensions");this.data.push(Float64Array.from(r[o]))}}}this.rows=t,this.columns=e}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){if(p(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),p(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(g(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let o=0;o<t;o++)r[o]=this.data[e][o];for(let o=t+1;o<this.columns;o++)r[o-1]=this.data[e][o];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){"undefined"===typeof e&&(e=t,t=this.columns),g(this,t,!0),e=w(this,e);for(let r=0;r<this.rows;r++){const o=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)o[n]=this.data[r][n];for(o[n++]=e[r];n<this.columns+1;n++)o[n]=this.data[r][n-1];this.data[r]=o}return this.columns+=1,this}}var R,A;A=_,(R=E).prototype.add=function(t){return"number"===typeof t?this.addS(t):this.addM(t)},R.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},R.prototype.addM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},R.add=function(t,e){return new A(t).add(e)},R.prototype.sub=function(t){return"number"===typeof t?this.subS(t):this.subM(t)},R.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},R.prototype.subM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},R.sub=function(t,e){return new A(t).sub(e)},R.prototype.subtract=R.prototype.sub,R.prototype.subtractS=R.prototype.subS,R.prototype.subtractM=R.prototype.subM,R.subtract=R.sub,R.prototype.mul=function(t){return"number"===typeof t?this.mulS(t):this.mulM(t)},R.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},R.prototype.mulM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},R.mul=function(t,e){return new A(t).mul(e)},R.prototype.multiply=R.prototype.mul,R.prototype.multiplyS=R.prototype.mulS,R.prototype.multiplyM=R.prototype.mulM,R.multiply=R.mul,R.prototype.div=function(t){return"number"===typeof t?this.divS(t):this.divM(t)},R.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},R.prototype.divM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},R.div=function(t,e){return new A(t).div(e)},R.prototype.divide=R.prototype.div,R.prototype.divideS=R.prototype.divS,R.prototype.divideM=R.prototype.divM,R.divide=R.div,R.prototype.mod=function(t){return"number"===typeof t?this.modS(t):this.modM(t)},R.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},R.prototype.modM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},R.mod=function(t,e){return new A(t).mod(e)},R.prototype.modulus=R.prototype.mod,R.prototype.modulusS=R.prototype.modS,R.prototype.modulusM=R.prototype.modM,R.modulus=R.mod,R.prototype.and=function(t){return"number"===typeof t?this.andS(t):this.andM(t)},R.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},R.prototype.andM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},R.and=function(t,e){return new A(t).and(e)},R.prototype.or=function(t){return"number"===typeof t?this.orS(t):this.orM(t)},R.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},R.prototype.orM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},R.or=function(t,e){return new A(t).or(e)},R.prototype.xor=function(t){return"number"===typeof t?this.xorS(t):this.xorM(t)},R.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},R.prototype.xorM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},R.xor=function(t,e){return new A(t).xor(e)},R.prototype.leftShift=function(t){return"number"===typeof t?this.leftShiftS(t):this.leftShiftM(t)},R.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},R.prototype.leftShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},R.leftShift=function(t,e){return new A(t).leftShift(e)},R.prototype.signPropagatingRightShift=function(t){return"number"===typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},R.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},R.prototype.signPropagatingRightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},R.signPropagatingRightShift=function(t,e){return new A(t).signPropagatingRightShift(e)},R.prototype.rightShift=function(t){return"number"===typeof t?this.rightShiftS(t):this.rightShiftM(t)},R.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},R.prototype.rightShiftM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},R.rightShift=function(t,e){return new A(t).rightShift(e)},R.prototype.zeroFillRightShift=R.prototype.rightShift,R.prototype.zeroFillRightShiftS=R.prototype.rightShiftS,R.prototype.zeroFillRightShiftM=R.prototype.rightShiftM,R.zeroFillRightShift=R.rightShift,R.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},R.not=function(t){return new A(t).not()},R.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},R.abs=function(t){return new A(t).abs()},R.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},R.acos=function(t){return new A(t).acos()},R.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},R.acosh=function(t){return new A(t).acosh()},R.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},R.asin=function(t){return new A(t).asin()},R.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},R.asinh=function(t){return new A(t).asinh()},R.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},R.atan=function(t){return new A(t).atan()},R.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},R.atanh=function(t){return new A(t).atanh()},R.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},R.cbrt=function(t){return new A(t).cbrt()},R.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},R.ceil=function(t){return new A(t).ceil()},R.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},R.clz32=function(t){return new A(t).clz32()},R.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},R.cos=function(t){return new A(t).cos()},R.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},R.cosh=function(t){return new A(t).cosh()},R.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},R.exp=function(t){return new A(t).exp()},R.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},R.expm1=function(t){return new A(t).expm1()},R.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},R.floor=function(t){return new A(t).floor()},R.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},R.fround=function(t){return new A(t).fround()},R.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},R.log=function(t){return new A(t).log()},R.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},R.log1p=function(t){return new A(t).log1p()},R.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},R.log10=function(t){return new A(t).log10()},R.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},R.log2=function(t){return new A(t).log2()},R.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},R.round=function(t){return new A(t).round()},R.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},R.sign=function(t){return new A(t).sign()},R.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},R.sin=function(t){return new A(t).sin()},R.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},R.sinh=function(t){return new A(t).sinh()},R.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},R.sqrt=function(t){return new A(t).sqrt()},R.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},R.tan=function(t){return new A(t).tan()},R.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},R.tanh=function(t){return new A(t).tanh()},R.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},R.trunc=function(t){return new A(t).trunc()},R.pow=function(t,e){return new A(t).pow(e)},R.prototype.pow=function(t){return"number"===typeof t?this.powS(t):this.powM(t)},R.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},R.prototype.powM=function(t){if(t=A.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};class k extends E{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function O(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class j{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=k.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");let o,n,s=t.columns,i=new _(s,s),u=new Float64Array(s),a=new Float64Array(s),l=t,h=!1;if(h=!!r||t.isSymmetric(),h){for(o=0;o<s;o++)for(n=0;n<s;n++)i.set(o,n,l.get(o,n));!function(t,e,r,o){let n,s,i,u,a,l,h,c;for(a=0;a<t;a++)r[a]=o.get(t-1,a);for(u=t-1;u>0;u--){for(c=0,i=0,l=0;l<u;l++)c+=Math.abs(r[l]);if(0===c)for(e[u]=r[u-1],a=0;a<u;a++)r[a]=o.get(u-1,a),o.set(u,a,0),o.set(a,u,0);else{for(l=0;l<u;l++)r[l]/=c,i+=r[l]*r[l];for(n=r[u-1],s=Math.sqrt(i),n>0&&(s=-s),e[u]=c*s,i-=n*s,r[u-1]=n-s,a=0;a<u;a++)e[a]=0;for(a=0;a<u;a++){for(n=r[a],o.set(a,u,n),s=e[a]+o.get(a,a)*n,l=a+1;l<=u-1;l++)s+=o.get(l,a)*r[l],e[l]+=o.get(l,a)*n;e[a]=s}for(n=0,a=0;a<u;a++)e[a]/=i,n+=e[a]*r[a];for(h=n/(i+i),a=0;a<u;a++)e[a]-=h*r[a];for(a=0;a<u;a++){for(n=r[a],s=e[a],l=a;l<=u-1;l++)o.set(l,a,o.get(l,a)-(n*e[l]+s*r[l]));r[a]=o.get(u-1,a),o.set(u,a,0)}}r[u]=i}for(u=0;u<t-1;u++){if(o.set(t-1,u,o.get(u,u)),o.set(u,u,1),i=r[u+1],0!==i){for(l=0;l<=u;l++)r[l]=o.get(l,u+1)/i;for(a=0;a<=u;a++){for(s=0,l=0;l<=u;l++)s+=o.get(l,u+1)*o.get(l,a);for(l=0;l<=u;l++)o.set(l,a,o.get(l,a)-s*r[l])}}for(l=0;l<=u;l++)o.set(l,u+1,0)}for(a=0;a<t;a++)r[a]=o.get(t-1,a),o.set(t-1,a,0);o.set(t-1,t-1,1),e[0]=0}(s,a,u,i),function(t,e,r,o){let n,s,i,u,a,l,h,c,f,m,p,g,d,w,b,y,M;for(i=1;i<t;i++)e[i-1]=e[i];e[t-1]=0;let v=0,x=0,E=Number.EPSILON;for(l=0;l<t;l++){for(x=Math.max(x,Math.abs(r[l])+Math.abs(e[l])),h=l;h<t&&!(Math.abs(e[h])<=E*x);)h++;if(h>l){M=0;do{for(M+=1,n=r[l],c=(r[l+1]-n)/(2*e[l]),f=O(c,1),c<0&&(f=-f),r[l]=e[l]/(c+f),r[l+1]=e[l]*(c+f),m=r[l+1],s=n-r[l],i=l+2;i<t;i++)r[i]-=s;for(v+=s,c=r[h],p=1,g=p,d=p,w=e[l+1],b=0,y=0,i=h-1;i>=l;i--)for(d=g,g=p,y=b,n=p*e[i],s=p*c,f=O(c,e[i]),e[i+1]=b*f,b=e[i]/f,p=c/f,c=p*r[i]-b*n,r[i+1]=s+b*(p*n+b*r[i]),a=0;a<t;a++)s=o.get(a,i+1),o.set(a,i+1,b*o.get(a,i)+p*s),o.set(a,i,p*o.get(a,i)-b*s);c=-b*y*d*w*e[l]/m,e[l]=b*c,r[l]=p*c}while(Math.abs(e[l])>E*x)}r[l]=r[l]+v,e[l]=0}for(i=0;i<t-1;i++){for(a=i,c=r[i],u=i+1;u<t;u++)r[u]<c&&(a=u,c=r[u]);if(a!==i)for(r[a]=r[i],r[i]=c,u=0;u<t;u++)c=o.get(u,i),o.set(u,i,o.get(u,a)),o.set(u,a,c)}}(s,a,u,i)}else{let t=new _(s,s),e=new Float64Array(s);for(n=0;n<s;n++)for(o=0;o<s;o++)t.set(o,n,l.get(o,n));!function(t,e,r,o){let n,s,i,u,a,l,h,c=0,f=t-1;for(l=c+1;l<=f-1;l++){for(h=0,u=l;u<=f;u++)h+=Math.abs(e.get(u,l-1));if(0!==h){for(i=0,u=f;u>=l;u--)r[u]=e.get(u,l-1)/h,i+=r[u]*r[u];for(s=Math.sqrt(i),r[l]>0&&(s=-s),i-=r[l]*s,r[l]=r[l]-s,a=l;a<t;a++){for(n=0,u=f;u>=l;u--)n+=r[u]*e.get(u,a);for(n/=i,u=l;u<=f;u++)e.set(u,a,e.get(u,a)-n*r[u])}for(u=0;u<=f;u++){for(n=0,a=f;a>=l;a--)n+=r[a]*e.get(u,a);for(n/=i,a=l;a<=f;a++)e.set(u,a,e.get(u,a)-n*r[a])}r[l]=h*r[l],e.set(l,l-1,h*s)}}for(u=0;u<t;u++)for(a=0;a<t;a++)o.set(u,a,u===a?1:0);for(l=f-1;l>=c+1;l--)if(0!==e.get(l,l-1)){for(u=l+1;u<=f;u++)r[u]=e.get(u,l-1);for(a=l;a<=f;a++){for(s=0,u=l;u<=f;u++)s+=r[u]*o.get(u,a);for(s=s/r[l]/e.get(l,l-1),u=l;u<=f;u++)o.set(u,a,o.get(u,a)+s*r[u])}}}(s,t,e,i),function(t,e,r,o,n){let s,i,u,a,l,h,c,f,m,p,g,d,w,b,y,M=t-1,v=0,x=t-1,E=Number.EPSILON,S=0,_=0,R=0,A=0,k=0,O=0,j=0,C=0;for(s=0;s<t;s++)for((s<v||s>x)&&(r[s]=n.get(s,s),e[s]=0),i=Math.max(s-1,0);i<t;i++)_+=Math.abs(n.get(s,i));for(;M>=v;){for(a=M;a>v&&(O=Math.abs(n.get(a-1,a-1))+Math.abs(n.get(a,a)),0===O&&(O=_),!(Math.abs(n.get(a,a-1))<E*O));)a--;if(a===M)n.set(M,M,n.get(M,M)+S),r[M]=n.get(M,M),e[M]=0,M--,C=0;else if(a===M-1){if(c=n.get(M,M-1)*n.get(M-1,M),R=(n.get(M-1,M-1)-n.get(M,M))/2,A=R*R+c,j=Math.sqrt(Math.abs(A)),n.set(M,M,n.get(M,M)+S),n.set(M-1,M-1,n.get(M-1,M-1)+S),f=n.get(M,M),A>=0){for(j=R>=0?R+j:R-j,r[M-1]=f+j,r[M]=r[M-1],0!==j&&(r[M]=f-c/j),e[M-1]=0,e[M]=0,f=n.get(M,M-1),O=Math.abs(f)+Math.abs(j),R=f/O,A=j/O,k=Math.sqrt(R*R+A*A),R/=k,A/=k,i=M-1;i<t;i++)j=n.get(M-1,i),n.set(M-1,i,A*j+R*n.get(M,i)),n.set(M,i,A*n.get(M,i)-R*j);for(s=0;s<=M;s++)j=n.get(s,M-1),n.set(s,M-1,A*j+R*n.get(s,M)),n.set(s,M,A*n.get(s,M)-R*j);for(s=v;s<=x;s++)j=o.get(s,M-1),o.set(s,M-1,A*j+R*o.get(s,M)),o.set(s,M,A*o.get(s,M)-R*j)}else r[M-1]=f+R,r[M]=f+R,e[M-1]=j,e[M]=-j;M-=2,C=0}else{if(f=n.get(M,M),m=0,c=0,a<M&&(m=n.get(M-1,M-1),c=n.get(M,M-1)*n.get(M-1,M)),10===C){for(S+=f,s=v;s<=M;s++)n.set(s,s,n.get(s,s)-f);O=Math.abs(n.get(M,M-1))+Math.abs(n.get(M-1,M-2)),f=m=.75*O,c=-.4375*O*O}if(30===C&&(O=(m-f)/2,O=O*O+c,O>0)){for(O=Math.sqrt(O),m<f&&(O=-O),O=f-c/((m-f)/2+O),s=v;s<=M;s++)n.set(s,s,n.get(s,s)-O);S+=O,f=m=c=.964}for(C+=1,l=M-2;l>=a&&(j=n.get(l,l),k=f-j,O=m-j,R=(k*O-c)/n.get(l+1,l)+n.get(l,l+1),A=n.get(l+1,l+1)-j-k-O,k=n.get(l+2,l+1),O=Math.abs(R)+Math.abs(A)+Math.abs(k),R/=O,A/=O,k/=O,l!==a)&&!(Math.abs(n.get(l,l-1))*(Math.abs(A)+Math.abs(k))<E*(Math.abs(R)*(Math.abs(n.get(l-1,l-1))+Math.abs(j)+Math.abs(n.get(l+1,l+1)))));)l--;for(s=l+2;s<=M;s++)n.set(s,s-2,0),s>l+2&&n.set(s,s-3,0);for(u=l;u<=M-1&&(b=u!==M-1,u!==l&&(R=n.get(u,u-1),A=n.get(u+1,u-1),k=b?n.get(u+2,u-1):0,f=Math.abs(R)+Math.abs(A)+Math.abs(k),0!==f&&(R/=f,A/=f,k/=f)),0!==f);u++)if(O=Math.sqrt(R*R+A*A+k*k),R<0&&(O=-O),0!==O){for(u!==l?n.set(u,u-1,-O*f):a!==l&&n.set(u,u-1,-n.get(u,u-1)),R+=O,f=R/O,m=A/O,j=k/O,A/=R,k/=R,i=u;i<t;i++)R=n.get(u,i)+A*n.get(u+1,i),b&&(R+=k*n.get(u+2,i),n.set(u+2,i,n.get(u+2,i)-R*j)),n.set(u,i,n.get(u,i)-R*f),n.set(u+1,i,n.get(u+1,i)-R*m);for(s=0;s<=Math.min(M,u+3);s++)R=f*n.get(s,u)+m*n.get(s,u+1),b&&(R+=j*n.get(s,u+2),n.set(s,u+2,n.get(s,u+2)-R*k)),n.set(s,u,n.get(s,u)-R),n.set(s,u+1,n.get(s,u+1)-R*A);for(s=v;s<=x;s++)R=f*o.get(s,u)+m*o.get(s,u+1),b&&(R+=j*o.get(s,u+2),o.set(s,u+2,o.get(s,u+2)-R*k)),o.set(s,u,o.get(s,u)-R),o.set(s,u+1,o.get(s,u+1)-R*A)}}}if(0===_)return;for(M=t-1;M>=0;M--)if(R=r[M],A=e[M],0===A)for(a=M,n.set(M,M,1),s=M-1;s>=0;s--){for(c=n.get(s,s)-R,k=0,i=a;i<=M;i++)k+=n.get(s,i)*n.get(i,M);if(e[s]<0)j=c,O=k;else if(a=s,0===e[s]?n.set(s,M,0!==c?-k/c:-k/(E*_)):(f=n.get(s,s+1),m=n.get(s+1,s),A=(r[s]-R)*(r[s]-R)+e[s]*e[s],h=(f*O-j*k)/A,n.set(s,M,h),n.set(s+1,M,Math.abs(f)>Math.abs(j)?(-k-c*h)/f:(-O-m*h)/j)),h=Math.abs(n.get(s,M)),E*h*h>1)for(i=s;i<=M;i++)n.set(i,M,n.get(i,M)/h)}else if(A<0)for(a=M-1,Math.abs(n.get(M,M-1))>Math.abs(n.get(M-1,M))?(n.set(M-1,M-1,A/n.get(M,M-1)),n.set(M-1,M,-(n.get(M,M)-R)/n.get(M,M-1))):(y=I(0,-n.get(M-1,M),n.get(M-1,M-1)-R,A),n.set(M-1,M-1,y[0]),n.set(M-1,M,y[1])),n.set(M,M-1,0),n.set(M,M,1),s=M-2;s>=0;s--){for(p=0,g=0,i=a;i<=M;i++)p+=n.get(s,i)*n.get(i,M-1),g+=n.get(s,i)*n.get(i,M);if(c=n.get(s,s)-R,e[s]<0)j=c,k=p,O=g;else if(a=s,0===e[s]?(y=I(-p,-g,c,A),n.set(s,M-1,y[0]),n.set(s,M,y[1])):(f=n.get(s,s+1),m=n.get(s+1,s),d=(r[s]-R)*(r[s]-R)+e[s]*e[s]-A*A,w=2*(r[s]-R)*A,0===d&&0===w&&(d=E*_*(Math.abs(c)+Math.abs(A)+Math.abs(f)+Math.abs(m)+Math.abs(j))),y=I(f*k-j*p+A*g,f*O-j*g-A*p,d,w),n.set(s,M-1,y[0]),n.set(s,M,y[1]),Math.abs(f)>Math.abs(j)+Math.abs(A)?(n.set(s+1,M-1,(-p-c*n.get(s,M-1)+A*n.get(s,M))/f),n.set(s+1,M,(-g-c*n.get(s,M)-A*n.get(s,M-1))/f)):(y=I(-k-m*n.get(s,M-1),-O-m*n.get(s,M),j,A),n.set(s+1,M-1,y[0]),n.set(s+1,M,y[1]))),h=Math.max(Math.abs(n.get(s,M-1)),Math.abs(n.get(s,M))),E*h*h>1)for(i=s;i<=M;i++)n.set(i,M-1,n.get(i,M-1)/h),n.set(i,M,n.get(i,M)/h)}for(s=0;s<t;s++)if(s<v||s>x)for(i=s;i<t;i++)o.set(s,i,n.get(s,i));for(i=t-1;i>=v;i--)for(s=v;s<=x;s++){for(j=0,u=v;u<=Math.min(i,x);u++)j+=o.get(s,u)*n.get(u,i);o.set(s,i,j)}}(s,a,u,i,t)}this.n=s,this.e=a,this.d=u,this.V=i}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,o=this.e,n=this.d,s=new _(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)s.set(t,e,0);s.set(t,t,n[t]),o[t]>0?s.set(t,t+1,o[t]):o[t]<0&&s.set(t,t-1,o[t])}return s}}function I(t,e,r,o){let n,s;return Math.abs(r)>Math.abs(o)?(n=o/r,s=r+n*o,[(t+n*e)/s,(e-n*t)/s]):(n=r/o,s=o+n*r,[(n*t+e)/s,(n*e-t)/s])}var C=r("b/IV"),T=400,q=function(t,e){return 20*t+e},P=null;e.default=function(t){return function(e){var r=0;!function(){if(null===P){for(var t=_.zeros(T,T),e=0;e<20;e++)for(var r=0;r<20;r++){var o=(e>0?1:0)+(e<19?1:0)+(r>0?1:0)+(r<19?1:0);t.set(q(e,r),q(e,r),o),e>0&&t.set(q(e,r),q(e-1,r),-1),e<19&&t.set(q(e,r),q(e+1,r),-1),r>0&&t.set(q(e,r),q(e,r-1),-1),r<19&&t.set(q(e,r),q(e,r+1),-1)}P=new j(t)}}();var o=P.realEigenvalues,s=P.eigenvectorMatrix,i=n(o);e.setup=function(){e.createCanvas(400,400)},e.draw=function(){r+=1/60;var u=t.harmonic;e.background(128);for(var a=0;a<T;a++)i[a]=s.get(a,u);var l=i.map(Math.abs),h=Math.max.apply(Math,n(l));h>.01&&(i=i.map((function(t){return t/h})));for(var c=0;c<20;c++)for(var f=0;f<20;f++){var m=20*c,p=20*f,g=.5*i[q(c,f)]*Math.sin(12*r*Math.sqrt(Math.max(o[u],0)))+.5;e.push(),e.fill(C(g)),e.strokeWeight(0),e.rect(p,m,20,20),e.pop()}}}}},NgQY:function(t,e,r){"use strict";var o=r("q1tI"),n=r.n(o),s=r("8Kt/"),i=r.n(s),u=n.a.createElement;e.a=function(){return u(i.a,null,u("script",{src:"/quicklink.umd.js",key:"quicklink"}),u("script",{dangerouslySetInnerHTML:{__html:"window.addEventListener('load',()=>quicklink.listen())"}}))}},O3X2:function(t,e,r){"use strict";function o(t){return"00".slice(t.length)+t}t.exports=function(t){return"#"+[t.r,t.g,t.b].map((function(t){return Math.round(255*t).toString(16)})).map(o).join("")}},Qetd:function(t,e,r){"use strict";var o=Object.assign.bind(Object);t.exports=o,t.exports.default=t.exports},T0f4:function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(e)}t.exports=r},Xuae:function(t,e,r){"use strict";var o=r("mPvQ"),n=r("/GRZ"),s=r("i2R6"),i=(r("qXWd"),r("48fX")),u=r("tCBg"),a=r("T0f4");function l(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=a(t);if(e){var n=a(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return u(this,r)}}e.__esModule=!0,e.default=void 0;var h=r("q1tI"),c=function(t){i(r,t);var e=l(r);function r(t){var s;return n(this,r),(s=e.call(this,t))._hasHeadManager=void 0,s.emitChange=function(){s._hasHeadManager&&s.props.headManager.updateHead(s.props.reduceComponentsToState(o(s.props.headManager.mountedInstances),s.props))},s._hasHeadManager=s.props.headManager&&s.props.headManager.mountedInstances,s}return s(r,[{key:"componentDidMount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.add(this),this.emitChange()}},{key:"componentDidUpdate",value:function(){this.emitChange()}},{key:"componentWillUnmount",value:function(){this._hasHeadManager&&this.props.headManager.mountedInstances.delete(this),this.emitChange()}},{key:"render",value:function(){return null}}]),r}(h.Component);e.default=c},YJt9:function(t,e,r){"use strict";var o=r("paH9"),n=r("O3X2");function s(t,e){t=o(t),e=o(e);var r=t.r,s=t.g,i=t.b,u=e.r-r,a=e.g-s,l=e.b-i;return function(t){return n({r:r+u*t,g:s+a*t,b:i+l*t})}}t.exports={interpolate:s,interpolateArray:function(t){for(var e=t.length-2,r=1/e,o=[],n=0;n<=e;n++)o[n]=s(t[n],t[n+1]);return function(t){if(t<0||t>1)throw new Error("Outside the allowed range of [0, 1]");var n=Math.floor(t*e),s=n*r;return o[n](t/r-s/r)}}}},Z51P:function(t,e,r){"use strict";r.r(e);var o=r("q1tI"),n=r("a6RD"),s=r.n(n),i=r("8Kt/"),u=r.n(i),a=r("apO0"),l=r("NgQY"),h=o.createElement,c=s()((function(){return Promise.all([r.e(3),r.e(15)]).then(r.t.bind(null,"58Bg",7))}),{loading:function(){return h("p",null,"Loading...")},ssr:!1,loadableGenerated:{webpack:function(){return["58Bg"]},modules:["react-p5-wrapper"]}});e.default=function(){var t=r("NTCN"),e=t.default,o=(t.EigenmodesProps,t.ELEMS),n={harmonic:20};return h(a.a,{title:"Eigenmodes (WIP) // Visuals // Lawrence Wu",description:"Visualization of solutions to the wave equation on a graph, by eigendecomposition of the Laplacian."},h(u.a,null,h("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"Lawrence Wu",item:"https://llwu.me"},{"@type":"ListItem",position:2,name:"Visuals",item:"https://llwu.me/visuals"},{"@type":"ListItem",position:3,name:"Eigenmodes"}]})}})),h(l.a,null),h("h1",null,"Eigenmodes (WIP) //"," ",h("a",{href:"/visuals"},"Visuals")," //"," ",h("a",{href:"/"},"Lawrence Wu")),"Eigenvalue #",h("input",{type:"number",defaultValue:20,onChange:function(t){var e=Number(t.target.value);n.harmonic=e>=0?e<o?e:o-1:0}})," ","(range from 0 to ",o-1,")",h("hr",null),h(c,{sketch:e(n)}),h("hr",null),h("a",{href:"https://github.com/llwu/llwu.github.io/blob/master/sketches/eigenmodes/index.ts",target:"_blank",rel:"noreferrer"},"View Source on GitHub"))}},a6RD:function(t,e,r){"use strict";var o=r("oI91");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}e.__esModule=!0,e.noSSR=a,e.default=function(t,e){var r=i.default,o={loading:function(t){t.error,t.isLoading;return t.pastDelay,null}};t instanceof Promise?o.loader=function(){return t}:"function"===typeof t?o.loader=t:"object"===typeof t&&(o=s(s({},o),t));if(o=s(s({},o),e),"object"===typeof t&&!(t instanceof Promise)&&(t.render&&(o.render=function(e,r){return t.render(r,e)}),t.modules)){r=i.default.Map;var n={},u=t.modules();Object.keys(u).forEach((function(t){var e=u[t];"function"!==typeof e.then?n[t]=e:n[t]=function(){return e.then((function(t){return t.default||t}))}})),o.loader=n}o.loadableGenerated&&delete(o=s(s({},o),o.loadableGenerated)).loadableGenerated;if("boolean"===typeof o.ssr){if(!o.ssr)return delete o.ssr,a(r,o);delete o.ssr}return r(o)};u(r("q1tI"));var i=u(r("2qu3"));function u(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return delete e.webpack,delete e.modules,t(e)}},apO0:function(t,e,r){"use strict";var o=r("q1tI"),n=r.n(o),s=r("8Kt/"),i=r.n(s),u=n.a.createElement;e.a=function(t){var e=t.children,r=t.title,o=void 0===r?"Lawrence Wu":r,n=t.description,s=void 0===n?"":n;return u("div",null,u(i.a,null,u("title",null,o),u("meta",{charSet:"utf-8"}),u("link",{rel:"shortcut icon",href:"/favicon.ico"}),u("meta",{name:"description",content:s}),u("meta",{name:"twitter:card",content:"summary_large_image"}),u("meta",{name:"twitter:creator",content:"@llllvvuu"}),u("meta",{property:"og:title",content:"Lawrence Wu"}),u("meta",{property:"og:description",content:s}),u("meta",{property:"og:type",content:"website"})),u("div",{style:{maxWidth:"900px",margin:"auto",fontFamily:"Georgia,Times,Times New Roman,serif"}},e))}},"b/IV":function(t,e,r){"use strict";t.exports=r("YJt9").interpolateArray(r("ygck"))},i2R6:function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),t}},jwwS:function(t,e,r){"use strict";var o;e.__esModule=!0,e.LoadableContext=void 0;var n=((o=r("q1tI"))&&o.__esModule?o:{default:o}).default.createContext(null);e.LoadableContext=n},kG2m:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},lwAK:function(t,e,r){"use strict";var o;e.__esModule=!0,e.AmpStateContext=void 0;var n=((o=r("q1tI"))&&o.__esModule?o:{default:o}).default.createContext({});e.AmpStateContext=n},mPvQ:function(t,e,r){var o=r("5fIB"),n=r("rlHP"),s=r("KckH"),i=r("kG2m");t.exports=function(t){return o(t)||n(t)||s(t)||i()}},oI91:function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},paH9:function(t,e,r){"use strict";t.exports=function(t){return{r:parseInt(t.slice(1,3),16)/255,g:parseInt(t.slice(3,5),16)/255,b:parseInt(t.slice(5,7),16)/255}}},qXWd:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},qhzo:function(t,e){function r(e,o){return t.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(e,o)}t.exports=r},rlHP:function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},tCBg:function(t,e,r){var o=r("C+bE"),n=r("qXWd");t.exports=function(t,e){return!e||"object"!==o(e)&&"function"!==typeof e?n(t):e}},ygck:function(t){t.exports=JSON.parse('["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"]')}},[["1l7s",0,1]]]);